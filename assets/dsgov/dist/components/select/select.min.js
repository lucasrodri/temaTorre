class O{constructor(e,t){this.name=e,this.component=t,this.multiple=t.hasAttribute("multiple"),this._setOptionsList(),this._setBehavior()}get selected(){return this._optionSelected("value")}get selectedValue(){return this._optionSelected("inputValue")}_optionSelected(e){let t=[];for(const[o,s]of this.optionsList.entries())if(this.multiple)o>0&&s.selected&&t.push(s[e]);else if(s.selected){t=s[e];break}return t}_removeNotFoundElement(){const e=this.component.querySelector(".br-list");e.querySelector(".br-item.disabled")&&e.removeChild(e.querySelector(".br-item.disabled"))}_addNotFoundElement(){const e=document.createElement("div");e.classList.add("br-item"),e.classList.add("disabled"),e.appendChild(document.createTextNode("Item nÃ£o encontrado"));this.component.querySelector(".br-list").appendChild(e)}_setOptionsList(){this.optionsList=[];for(const e of this.component.querySelectorAll(".br-list .br-item"))for(const t of e.querySelectorAll(".br-radio input, .br-checkbox input")){const o={element:e,focus:!1,inputValue:t.value,selected:!1,value:t.nextElementSibling.innerText,visible:!0};this.optionsList.push(o)}}resetOptionsList(){this._unsetSelectionBehavior(),this._setOptionsList(),this._setSelectionBehavior()}_setBehavior(){this._setDropdownBehavior(),this._setKeyboardBehavior(),this._setSelectionBehavior(),this._setFilterBehavior()}_setDropdownBehavior(){for(const e of this.component.querySelectorAll('.br-input input[type="text"]'))e.addEventListener("focus",()=>{this._openSelect(),this._resetFocus()});for(const e of this.component.querySelectorAll(".br-input .br-button[data-trigger]"))e.addEventListener("click",()=>{for(const e of this.component.querySelectorAll(".br-list"))e.hasAttribute("expanded")?this._closeSelect():this._openSelect()});window.document.addEventListener("click",e=>{this.component.contains(e.target)||this._closeSelect()})}_setKeyboardBehavior(){for(const e of this.component.querySelectorAll('.br-input input[type="text"]'))e.addEventListener("keydown",this._handleKeydownOnInput.bind(this));for(const e of this.component.querySelectorAll(".br-list"))e.addEventListener("keydown",this._handleKeydownOnList.bind(this))}_unsetKeyboardBehavior(){for(const e of this.component.querySelectorAll('.br-input input[type="text"]'))e.removeEventListener("keydown",this._handleKeydownOnInput,!1);for(const e of this.component.querySelectorAll(".br-list"))e.addEventListener("keydown",this._handleKeydownOnList.bind(this))}_handleKeydownOnInput(e){if(e.shiftKey&&"Tab"===e.key&&(this._closeSelect(),this._resetFocus()),"Tab"!==e.key||e.shiftKey||e.target.parentNode.querySelector(".br-button").focus(),40===e.keyCode){e.preventDefault();for(const e of this.component.querySelectorAll(".br-list"))e.focus(),e===document.activeElement&&this._getNextItem().focus()}}_handleKeydownOnList(e){switch(e.preventDefault(),e.keyCode){case 9:this._closeSelect(),this._resetFocus();break;case 27:this._closeSelect();break;case 32:this._setKeyClickOnOption(e.currentTarget);break;case 38:this._getPreviousItem().focus();break;case 40:this._getNextItem().focus()}}_setKeyClickOnOption(e){for(const[t,o]of e.querySelectorAll(".br-item").entries())if(this.optionsList[t].focus)for(const e of o.querySelectorAll('.br-radio input[type="radio"], .br-checkbox input[type="checkbox"]'))e.click()}_setDefaultSelected(){const e=this.component.querySelectorAll(".br-list .selected"),t=typeof e[Symbol.iterator];if(null!==e&&"function"===t)for(const t of e)this._setSelected(this._positionSelected(t),t)}_positionSelected(e){for(const[t,o]of this.component.querySelectorAll(".br-list .br-item").entries())if(o===e)return t;return 0}_handleClickOnCheck(e,t,o){if(this.multiple)o.currentTarget.hasAttribute("checked")?this._removeSelected(e,t):this._setSelected(e,t);else{for(const[e,t]of this.component.querySelectorAll(".br-list .br-item").entries())this._removeSelected(e,t);this._setSelected(e,t),this._closeSelect()}if(t.hasAttribute("data-all"))for(const e of t.querySelectorAll('.br-checkbox input[type="checkbox"]'))if(e.hasAttribute("checked")){for(const e of this.component.querySelectorAll(".br-list .br-item"))for(const t of e.querySelectorAll('.br-checkbox input[type="checkbox"]'))t.hasAttribute("checked")||t.click();t.querySelectorAll("label")[0].innerText="Deselecionar Todos"}else this._setAttribute(),t.querySelectorAll("label")[0].innerText="Selecionar Todos"}_setSelectionBehavior(){this.selectionHandler=[],this._setDefaultSelected();for(const[e,t]of this.component.querySelectorAll(".br-list .br-item").entries())for(const o of t.querySelectorAll('.br-radio input[type="radio"], .br-checkbox input[type="checkbox"]'))this.selectionHandler.push({element:o,handler:this._handleClickOnCheck.bind(this,e,t)}),o.addEventListener("click",this.selectionHandler[e].handler)}_unsetSelectionBehavior(){this.selectionHandler.forEach(e=>{e.element.removeEventListener("click",e.handler,!1)})}_setFilterBehavior(){for(const e of this.component.querySelectorAll('.br-input input[type="text"]'))e.addEventListener("input",e=>{let t=!0;this._filter(e.currentTarget.value);for(const e of this.optionsList)e.visible&&(t=!1);t&&this._filter(e.currentTarget.value)})}_filter(e){let t=!1;for(const[o,s]of this.component.querySelectorAll(".br-list .br-item").entries())this._removeNotFoundElement(),this.optionsList[o]&&(-1===this.optionsList[o].value.toUpperCase().indexOf(e.toUpperCase())?(s.classList.add("d-none"),this.optionsList[o].visible=!1):(s.classList.remove("d-none"),this.optionsList[o].visible=!0,t=!0));!1===t&&this._addNotFoundElement()}_setAttribute(){for(const e of this.component.querySelectorAll(".br-list .br-item"))for(const t of e.querySelectorAll('.br-checkbox input[type="checkbox"]'))t.hasAttribute("checked")&&t.click()}_setSelected(e,t){t.classList.add("selected");for(const e of t.querySelectorAll(".br-radio, .br-checkbox"))for(const t of e.querySelectorAll('input[type="radio"], input[type="checkbox"]'))t.setAttribute("checked","");this.optionsList[e].selected=!0,this._setInput()}_removeSelected(e,t){t.classList.remove("selected");for(const o of t.querySelectorAll(".br-radio, .br-checkbox")){for(const e of o.querySelectorAll('input[type="radio"], input[type="checkbox"'))e.removeAttribute("checked");this.optionsList[e].selected=!1,this._setInput()}}_setInput(){for(const e of this.component.querySelectorAll('.br-input input[type="text"]'))this.multiple?0===this.selected.length?e.value="":1===this.selected.length?e.value=this.selected:e.value=`${this.selected[0]} + (${this.selected.length-1})`:e.value=this.selected}_getNextItem(){const e=this.component.querySelectorAll(".br-list .br-item");let t,o;for(t=0;t<this.optionsList.length;t++)if(this.optionsList[t].focus){for(o=t+1;o<this.optionsList.length&&!this.optionsList[o].visible;o++);break}if(t!==this.optionsList.length)return o<this.optionsList.length?(this.optionsList[t].focus=!1,this.optionsList[o].focus=!0,e[o]):e[t];for(const[t,o]of this.optionsList.entries())if(o.visible)return o.focus=!0,e[t];return""}_getPreviousItem(){const e=this.component.querySelectorAll(".br-list .br-item");let t,o;for(t=0;t<this.optionsList.length;t++)if(this.optionsList[t].focus){for(o=t-1;o>0&&!this.optionsList[o].visible;o--);break}return 0===t?e[t]:(this.optionsList[t].focus=!1,this.optionsList[o].focus=!0,e[o])}_resetInput(){for(const e of this.component.querySelectorAll('.br-input input[type="text"]'))e.value=""}_resetFocus(){for(const e of this.optionsList)e.focus=!1}_resetVisible(){const e=this.component.querySelectorAll(".br-list .br-item");for(const[t,o]of this.optionsList.entries())o.visible=!0,e[t].classList.remove("d-none")}_openSelect(){for(const e of this.component.querySelectorAll(".br-list"))e.setAttribute("expanded","");for(const e of this.component.querySelectorAll(".br-input .br-button i"))e.classList.remove("fa-angle-down"),e.classList.add("fa-angle-up");this._resetInput()}_closeSelect(){for(const e of this.component.querySelectorAll(".br-list"))e.removeAttribute("expanded");for(const e of this.component.querySelectorAll(".br-input .br-button i"))e.classList.remove("fa-angle-up"),e.classList.add("fa-angle-down");this._setInput(),this._resetFocus(),this._resetVisible()}}export default O;